{% extends 'base.html' %}

{% block content %}
    <form action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data">
        {{ form.hidden_tag() }}
        {{ form.pdf_file(id="pdfInput", accept="application/pdf") }}
        
        <div id="pdfDisplay" class="">
            <!-- The PDF will be displayed here -->
        </div>
        
        <button type="submit">{{ form.submit.label }}</button>
        
        {% for error in form.pdf_file.errors %}
            <div style="color: red;">{{ error }}</div>
        {% endfor %}
    </form>

    <script>
        document.getElementById('pdfInput').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file && file.type === "application/pdf") {
                const fileURL = URL.createObjectURL(file);
                document.getElementById('pdfDisplay').style.cssText = "width: 50%; height: 500px; border: 1px solid #ccc;";
                document.getElementById('pdfDisplay').innerHTML = `
                    <object data="${fileURL}" type="application/pdf" width="100%" height="100%">
                        <p>Your browser does not support PDFs.
                            <a href="${fileURL}">Download the PDF</a> to view it.</p>
                    </object>
                `;
            } else {
                alert("Please upload a valid PDF file.");
            }
        });
    </script>
{% endblock %}

